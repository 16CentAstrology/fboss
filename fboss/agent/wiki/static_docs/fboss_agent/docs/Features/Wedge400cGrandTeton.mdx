
Wedge400c                                                                                   

Front Port-mapping:                                                                
In Wedge400C system, the logic connection of switching ASIC port mapping is shown below:                                                                                                                            
                                        
Switch ASIC Port-mapping:                                                                       
There are 16 QSFP-DD ports and 32 QSFP-56 ports on Wedge400C. The front panel placement is shown as below.                                                                                                                                                              
                                                                                                                                            
There are 256 SERDES lanes from switching ASIC to the front panel traffic ports. The following table shows the port mapping of ASIC SERDES and ports.                                               
                                                                                      
Wedge400C GrandTeton
            
Wedge400 2x200G(Front-end):        
2x200G on the QDD ports. Because of supply risk issues and NVIDIA unable to meet the timeline for 2x200G (QSFP), we pivoted towards this approach. It required us to support QDD (first row in wedge400 which has been used for uplink connectivity) for 2x200G DAC for downlinks. This mode is special not only because we use the port split , but also because we use the QDD ports for downlinks.

Wedge400C 2x200G(Front-end):      
The support for Wedge400C is being done for parity with Wedge400 for front end. In DVT, we expect both wedge400 and Wedge400C to be present in the GT racks. Wedge400C had no 200G deployments so far and this will be the first one.

Uplink and Downlink QDD ports:     
Frontpanel QDD ports 1, 3, 5, 7, 9, 11, 13, 15 are used as uplinks whereas 2, 4, 6, 8, 10, 12, 14, 16 are used as downlink ports. The downlink ports are broken out it into 2*200 G ports.

LaneMapping for breakout 2*200 G ports:     
The lane mapping for Wedge400C breakout QDD port is not contiguous for all the scenarios and itâ€™s not always true that the top 4 lanes are used for the first ports and next 4 lanes will be used for the second port.There are 8 ports with the upper and lower groups swapped. Ports 4,6,9-12,14,15.This needed special handling in the code for the lane-mapping.
For example, port 4 has physical [0:3] -> IFG8 [13:15] and physical [4:7] -> IFG8 [8:11]

Logical Id Mapping:  
There is a difference between logical-id mapping for uplink vs downlink QDD ports for Wedge400C.
uplink logical ids = [1,17,33,49,65,81,97,113]
down logical ids = [9,13,25,29,41,45,57,61,73,77,89,93,105,109,121,125]
The downlink logical ids are also different from Wedge400 and other platforms where the ids differ by 2 for subsequent downlink interfaces. But the subinterface numbering for breakout ports stays the same as the other platforms e.g. port 2 would be split into 1/2/1 and 1/2/3 .This needed special handling of deriving logicalIds for breakout ports for Wedge400C.

Serdes Settings:    
The following Tx settings needed to be used for the lanes of downlink ports:
                  fir_pre2 = 25
                  fir_pre1 = -125
                  fir_main = 800
                  fir_post1 = -50
                  DSP = 7
                  CTLE = 63
However, as it was the first deployment for 200G QSFP-DD, the serdes settings provided by Cisco for the lanes were not correct and needed to be modified.

3-Tap vs 7-Tap Settings:   
As part of serdes settings investigation, it was identified that current platforms support TX_LUT_MODE=0, which does not use TX_PRE2 settings and uses 3-Tap settings. However with TX_LUT_MODE=2, the support for 7-Tap settings can be extended which would make TX_PRE2 settings effective. As there has been performance improvement noticed in lab settings with CX6-DX NICs, there is a plan to implement 7-Tap settings.

